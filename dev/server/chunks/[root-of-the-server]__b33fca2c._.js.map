{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/asus/Desktop/LogIz/LogIz-LogIz/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js'\r\n\r\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL || 'https://tmavagzxznmmwecbudux.supabase.co'\r\nconst supabaseKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY || process.env.SUPABASE_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRtYXZhZ3p4em5tbXdlY2J1ZHV4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3MDAwMzksImV4cCI6MjA3ODI3NjAzOX0.mkHQy0e3LN0hZfxEmnin5dpgycWJ6NHOp5fltrFUQF8'\r\n\r\nif (!supabaseKey) {\r\n    console.warn('⚠️ Supply a SUPABASE_KEY to use the Supabase client.')\r\n}\r\n\r\nexport const supabase = createClient(supabaseUrl, supabaseKey)\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,cAAc,gFAAwC;AAC5D,MAAM,cAAc,wPAA6C,QAAQ,GAAG,CAAC,YAAY,IAAI;AAE7F;;AAIO,MAAM,WAAW,IAAA,yLAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 121, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/asus/Desktop/LogIz/LogIz-LogIz/lib/auth.ts"],"sourcesContent":["import { NextAuthOptions } from \"next-auth\"\r\nimport CredentialsProvider from \"next-auth/providers/credentials\"\r\nimport { supabase } from \"@/lib/supabase\"\r\nimport bcrypt from \"bcryptjs\"\r\n\r\nexport const authOptions: NextAuthOptions = {\r\n  providers: [\r\n    CredentialsProvider({\r\n      name: \"credentials\",\r\n      credentials: {\r\n        email: { label: \"Email\", type: \"email\" },\r\n        password: { label: \"Password\", type: \"password\" }\r\n      },\r\n      async authorize(credentials) {\r\n        if (!credentials?.email || !credentials?.password) {\r\n          throw new Error(\"Email and password required\")\r\n        }\r\n\r\n        // Fetch user from Supabase 'users' table\r\n        const { data: user, error } = await supabase\r\n          .from('users')\r\n          .select('*')\r\n          .eq('email', credentials.email)\r\n          .single()\r\n\r\n        if (error || !user || !user.password) {\r\n          throw new Error(\"Invalid credentials\")\r\n        }\r\n\r\n        const isPasswordValid = await bcrypt.compare(\r\n          credentials.password,\r\n          user.password\r\n        )\r\n\r\n        if (!isPasswordValid) {\r\n          throw new Error(\"Invalid credentials\")\r\n        }\r\n\r\n        return {\r\n          id: user.id,\r\n          email: user.email,\r\n          name: user.name,\r\n          role: user.role,\r\n        }\r\n      }\r\n    })\r\n  ],\r\n  session: {\r\n    strategy: \"jwt\"\r\n  },\r\n  pages: {\r\n    signIn: \"/login\",\r\n  },\r\n  callbacks: {\r\n    async jwt({ token, user }) {\r\n      if (user) {\r\n        token.id = user.id\r\n        token.role = user.role\r\n      }\r\n      return token\r\n    },\r\n    async session({ session, token }) {\r\n      if (session.user) {\r\n        session.user.id = token.id as string\r\n        session.user.role = token.role as string\r\n      }\r\n      return session\r\n    }\r\n  },\r\n  secret: process.env.NEXTAUTH_SECRET || \"development_secret_key_123\",\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;;;;AAEO,MAAM,cAA+B;IAC1C,WAAW;QACT,IAAA,qKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAQ;gBACvC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YACA,MAAM,WAAU,WAAW;gBACzB,IAAI,CAAC,aAAa,SAAS,CAAC,aAAa,UAAU;oBACjD,MAAM,IAAI,MAAM;gBAClB;gBAEA,yCAAyC;gBACzC,MAAM,EAAE,MAAM,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,6HAAQ,CACzC,IAAI,CAAC,SACL,MAAM,CAAC,KACP,EAAE,CAAC,SAAS,YAAY,KAAK,EAC7B,MAAM;gBAET,IAAI,SAAS,CAAC,QAAQ,CAAC,KAAK,QAAQ,EAAE;oBACpC,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,kBAAkB,MAAM,8IAAM,CAAC,OAAO,CAC1C,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGf,IAAI,CAAC,iBAAiB;oBACpB,MAAM,IAAI,MAAM;gBAClB;gBAEA,OAAO;oBACL,IAAI,KAAK,EAAE;oBACX,OAAO,KAAK,KAAK;oBACjB,MAAM,KAAK,IAAI;oBACf,MAAM,KAAK,IAAI;gBACjB;YACF;QACF;KACD;IACD,SAAS;QACP,UAAU;IACZ;IACA,OAAO;QACL,QAAQ;IACV;IACA,WAAW;QACT,MAAM,KAAI,EAAE,KAAK,EAAE,IAAI,EAAE;YACvB,IAAI,MAAM;gBACR,MAAM,EAAE,GAAG,KAAK,EAAE;gBAClB,MAAM,IAAI,GAAG,KAAK,IAAI;YACxB;YACA,OAAO;QACT;QACA,MAAM,SAAQ,EAAE,OAAO,EAAE,KAAK,EAAE;YAC9B,IAAI,QAAQ,IAAI,EAAE;gBAChB,QAAQ,IAAI,CAAC,EAAE,GAAG,MAAM,EAAE;gBAC1B,QAAQ,IAAI,CAAC,IAAI,GAAG,MAAM,IAAI;YAChC;YACA,OAAO;QACT;IACF;IACA,QAAQ,QAAQ,GAAG,CAAC,eAAe,IAAI;AACzC","debugId":null}},
    {"offset": {"line": 195, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/asus/Desktop/LogIz/LogIz-LogIz/app/api/categories/stats/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server'\r\nimport { createClient } from '@supabase/supabase-js'\r\nimport { getServerSession } from 'next-auth'\r\nimport { authOptions } from '@/lib/auth'\r\n\r\n// UNSW-NB15 based category definitions\r\nconst categoryConfig = [\r\n    { name: 'Normal', description: 'Meşru ağ trafiği', color: '#22c55e', risk: 'safe' },\r\n    { name: 'Generic', description: 'Genel saldırı kalıpları', color: '#8b5cf6', risk: 'medium' },\r\n    { name: 'Exploits', description: 'Sistem açıkları istismarı', color: '#ef4444', risk: 'critical' },\r\n    { name: 'Fuzzers', description: 'Fuzzing saldırı girişimleri', color: '#06b6d4', risk: 'medium' },\r\n    { name: 'DoS', description: 'Hizmet engelleme saldırıları', color: '#dc2626', risk: 'critical' },\r\n    { name: 'Reconnaissance', description: 'Ağ tarama ve keşif', color: '#f59e0b', risk: 'high' },\r\n    { name: 'Analysis', description: 'Trafik analiz saldırıları', color: '#0ea5e9', risk: 'low' },\r\n    { name: 'Backdoor', description: 'Arka kapı erişim girişimleri', color: '#7c3aed', risk: 'critical' },\r\n    { name: 'Shellcode', description: 'Zararlı shellcode çalıştırma', color: '#ec4899', risk: 'critical' },\r\n    { name: 'Worms', description: 'Kendi kendini çoğaltan zararlı', color: '#f43f5e', risk: 'critical' },\r\n]\r\n\r\nexport async function GET() {\r\n    try {\r\n        // Use Service Role client for public access\r\n        const supabaseAdmin = createClient(\r\n            process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n            process.env.SUPABASE_SERVICE_ROLE_KEY!,\r\n            {\r\n                auth: {\r\n                    autoRefreshToken: false,\r\n                    persistSession: false\r\n                }\r\n            }\r\n        )\r\n\r\n        // Optional user filtering\r\n        const session = await getServerSession(authOptions)\r\n        const userId = session?.user?.id\r\n\r\n        // Get analyses with their result JSON\r\n        let query = supabaseAdmin\r\n            .from('analyses')\r\n            .select('result')\r\n            .order('analyzed_at', { ascending: false })\r\n            .limit(100)\r\n\r\n        if (userId) {\r\n            query = query.eq('user_id', userId)\r\n        }\r\n\r\n        const { data: analyses, error } = await query\r\n\r\n        if (error) throw error\r\n\r\n        // Aggregate attack type distribution from all analyses\r\n        const typeCounts = new Map<string, number>()\r\n        let totalThreats = 0\r\n        let totalLogLines = 0\r\n\r\n        analyses?.forEach(analysis => {\r\n            const result = analysis.result as any\r\n            if (!result) return\r\n\r\n            // Add total log lines from each analysis\r\n            totalLogLines += result.totalLogLines || 0\r\n\r\n            // Use attack_type_distribution if available (from Python backend)\r\n            if (result.attack_type_distribution) {\r\n                Object.entries(result.attack_type_distribution).forEach(([type, count]: [string, any]) => {\r\n                    typeCounts.set(type, (typeCounts.get(type) || 0) + count)\r\n                    totalThreats += count\r\n                })\r\n            } else if (result.threats) {\r\n                // Fallback: count from threats array\r\n                result.threats.forEach((t: any) => {\r\n                    const type = t.type || 'Unknown'\r\n                    typeCounts.set(type, (typeCounts.get(type) || 0) + 1)\r\n                    totalThreats++\r\n                })\r\n            }\r\n        })\r\n\r\n        // Build category data with real counts\r\n        const categories = categoryConfig.map(config => {\r\n            const count = typeCounts.get(config.name) || 0\r\n            return {\r\n                ...config,\r\n                count,\r\n                percentage: 0,\r\n                trend: 0,\r\n            }\r\n        })\r\n\r\n        // Add any types not in config\r\n        typeCounts.forEach((count, type) => {\r\n            if (!categoryConfig.find(c => c.name === type)) {\r\n                categories.push({\r\n                    name: type,\r\n                    description: `${type} attacks`,\r\n                    color: '#6b7280',\r\n                    risk: 'medium',\r\n                    count,\r\n                    percentage: 0,\r\n                    trend: 0\r\n                })\r\n            }\r\n        })\r\n\r\n        // Calculate percentages\r\n        const totalCount = categories.reduce((sum, c) => sum + c.count, 0)\r\n        const withPercentages = categories.map(cat => ({\r\n            ...cat,\r\n            percentage: totalCount > 0 ? Math.round((cat.count / totalCount) * 1000) / 10 : 0\r\n        }))\r\n\r\n        // Sort by count descending\r\n        withPercentages.sort((a, b) => b.count - a.count)\r\n\r\n        // Summary stats\r\n        const threatEvents = withPercentages.filter(c => c.name !== 'Normal').reduce((sum, c) => sum + c.count, 0)\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            data: withPercentages,\r\n            stats: {\r\n                totalEvents: totalCount,\r\n                totalLogLines,\r\n                threatEvents,\r\n                normalPercentage: withPercentages.find(c => c.name === 'Normal')?.percentage || 0,\r\n                categoryCount: withPercentages.filter(c => c.count > 0).length,\r\n                isMockData: false\r\n            }\r\n        })\r\n    } catch (error) {\r\n        console.error('Error fetching category stats:', error)\r\n        return NextResponse.json(\r\n            { success: false, error: 'Failed to fetch category statistics', details: String(error) },\r\n            { status: 500 }\r\n        )\r\n    }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}
{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/asus/Desktop/LogIz/LogIz-LogIz/components/ThreatMap.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { MapContainer, TileLayer, Marker, Popup } from 'react-leaflet'\r\nimport L, { LatLngExpression } from 'leaflet'\r\nimport { useEffect, useState } from 'react'\r\n\r\n// Fix for default marker icon\r\nconst icon = L.icon({\r\n    iconUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon.png',\r\n    iconRetinaUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-icon-2x.png',\r\n    shadowUrl: 'https://unpkg.com/leaflet@1.7.1/dist/images/marker-shadow.png',\r\n    iconSize: [25, 41],\r\n    iconAnchor: [12, 41],\r\n    popupAnchor: [1, -34],\r\n    shadowSize: [41, 41]\r\n})\r\n\r\ninterface ThreatLocation {\r\n    lat: number\r\n    lon: number\r\n    country: string\r\n    ip: string\r\n    type: string\r\n    count: number\r\n}\r\n\r\ninterface Props {\r\n    threats: any[]\r\n}\r\n\r\nexport default function ThreatMap({ threats }: Props) {\r\n    const [cssLoaded, setCssLoaded] = useState(false)\r\n\r\n    // Load leaflet CSS dynamically\r\n    useEffect(() => {\r\n        const link = document.createElement('link')\r\n        link.rel = 'stylesheet'\r\n        link.href = 'https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'\r\n        link.integrity = 'sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY='\r\n        link.crossOrigin = ''\r\n        document.head.appendChild(link)\r\n        setCssLoaded(true)\r\n        return () => {\r\n            document.head.removeChild(link)\r\n        }\r\n    }, [])\r\n\r\n    // Group threats by location\r\n    const locations: ThreatLocation[] = []\r\n\r\n    threats.forEach(threat => {\r\n        if (threat.sourceLat && threat.sourceLon) {\r\n            const existing = locations.find(\r\n                l => l.lat === threat.sourceLat && l.lon === threat.sourceLon\r\n            )\r\n\r\n            if (existing) {\r\n                existing.count++\r\n            } else {\r\n                locations.push({\r\n                    lat: threat.sourceLat,\r\n                    lon: threat.sourceLon,\r\n                    country: threat.sourceCountry || 'Unknown',\r\n                    ip: threat.sourceIP,\r\n                    type: threat.type,\r\n                    count: 1\r\n                })\r\n            }\r\n        }\r\n    })\r\n\r\n    if (locations.length === 0) {\r\n        return (\r\n            <div className=\"h-[400px] w-full bg-gray-900/50 rounded-2xl border border-gray-700/50 overflow-hidden\">\r\n                {/* Header */}\r\n                <div className=\"flex items-center space-x-2 p-4 border-b border-gray-700/50\">\r\n                    <div className=\"p-2 rounded-lg bg-gradient-to-br from-emerald-500/20 to-cyan-500/20\">\r\n                        <svg className=\"w-5 h-5 text-emerald-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <div>\r\n                        <h3 className=\"text-lg font-semibold text-white\">Global Threat Map</h3>\r\n                        <p className=\"text-xs text-gray-400\">Geographic threat distribution</p>\r\n                    </div>\r\n                </div>\r\n                {/* Empty state */}\r\n                <div className=\"flex flex-col items-center justify-center h-[320px] text-center px-6\">\r\n                    <div className=\"w-16 h-16 rounded-full bg-gray-800/50 flex items-center justify-center mb-4\">\r\n                        <svg className=\"w-8 h-8 text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z\" />\r\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={1.5} d=\"M15 11a3 3 0 11-6 0 3 3 0 016 0z\" />\r\n                        </svg>\r\n                    </div>\r\n                    <p className=\"text-gray-400 text-sm mb-2\">No geolocation data available</p>\r\n                    <p className=\"text-gray-500 text-xs\">Threat locations will appear here when detected</p>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"h-[400px] w-full rounded-xl overflow-hidden border border-gray-700 z-0\">\r\n            <MapContainer\r\n                center={[20, 0] as LatLngExpression}\r\n                zoom={2}\r\n                style={{ height: '100%', width: '100%' }}\r\n                scrollWheelZoom={false}\r\n            >\r\n                <TileLayer\r\n                    url=\"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"\r\n                />\r\n                {locations.map((loc, idx) => (\r\n                    <Marker\r\n                        key={idx}\r\n                        position={[loc.lat, loc.lon] as LatLngExpression}\r\n                        icon={icon}\r\n                    >\r\n                        <Popup>\r\n                            <div className=\"p-2\">\r\n                                <h3 className=\"font-bold text-sm mb-1\">{loc.country}</h3>\r\n                                <p className=\"text-xs\">IP: {loc.ip}</p>\r\n                                <p className=\"text-xs\">Type: {loc.type}</p>\r\n                                <p className=\"text-xs font-semibold mt-1\">\r\n                                    {loc.count} Threat{loc.count > 1 ? 's' : ''} from this location\r\n                                </p>\r\n                            </div>\r\n                        </Popup>\r\n                    </Marker>\r\n                ))}\r\n            </MapContainer>\r\n        </div>\r\n    )\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}